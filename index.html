<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' https://script.google.com https://accounts.google.com;">
    <meta http-equiv="Permissions-Policy" content="identity-credentials-get=()">

    <title>Painel Interno com ChatBot - Velo Process</title>
    <link rel="icon" type="image/png" href="https://github.com/velobot05/Chatbot-Atendimento/blob/main/imagens/logo.png-removebg-preview%20(1).png?raw=true">
    
    <link rel="stylesheet" href="style.css">

    <script>
        function handleCredentialResponse(response) {
            try {
                const userObject = JSON.parse(atob(response.credential.split('.')[1]));
                const dadosAtendente = {
                    nome: userObject.name,
                    email: userObject.email,
                    foto: userObject.picture,
                    timestamp: Date.now()
                };

                const DOMINIO_PERMITIDO = "@velotax.com.br";
                if (!dadosAtendente.email.endsWith(DOMINIO_PERMITIDO)) {
                    alert("Acesso negado. Por favor, use uma conta Google com o dom√≠nio " + DOMINIO_PERMITIDO);
                    return;
                }

                localStorage.setItem('dadosAtendenteChatbot', JSON.stringify(dadosAtendente));
                
                document.getElementById('login-screen').style.display = 'none';
                document.querySelector('.app-wrapper').classList.remove('hidden');
                
                iniciarBot(dadosAtendente);

            } catch (error) {
                console.error("Erro ao processar o login do Google:", error);
                alert("Ocorreu um erro ao tentar fazer o login. Verifique o console para mais detalhes.");
            }
        }
    </script>
    
    <script src="https://accounts.google.com/gsi/client" async defer></script>

</head>
<body>

    <div id="login-screen">
        <div id="identificacao-box">
             <img src="https://github.com/VeloProcess/PDP-Portal-de-Processos-/blob/main/unnamed%20(2).png?raw=true" alt="Logo da Empresa" style="width: 100px; margin-bottom: 20px;">
            <h2>Bem-vindo(a) ao Painel de Atendimento</h2>
            <p>Por favor, fa√ßa login com sua conta Google para continuar.</p>
            
            <div id="g_id_onload"
                 data-client_id="COLE_SEU_ID_DO_CLIENTE_OAUTH_AQUI"
                 data-callback="handleCredentialResponse"
                 data-auto_select="true">
            </div>
            <div class="g_id_signin"
                 data-type="standard"
                 data-theme="outline"
                 data-size="large"
                 data-text="sign_in_with"
                 data-shape="rectangular"
                 data-logo_alignment="left">
            </div>
        </div>
    </div>

    <div class="app-wrapper hidden">
        <div id="sidebar" class="panel">
            <div class="panel-header">
                <h2>Perguntas Frequentes</h2>
            </div>
            <div class="sidebar-content">
                <div class="search-container">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="question-search" placeholder="Buscar perguntas...">
                </div>
                 <div class="question-category">Mais Comuns</div>
                 <ul id="quick-questions-list">
                     <li data-question="E-mail de procura√ß√£o, o que dizer?">E-mail de procura√ß√£o, o que dizer?</li>
                     <li data-question="Quero fazer a exclus√£o da minha conta">Quero fazer a exclus√£o da minha conta</li>
                     <li data-question="Problema no login do app">Problema no login do app</li>
                     <li data-question="Informa√ß√£o sobre os valores da restitui√ß√£o">Informa√ß√£o sobre os valores da restitui√ß√£o</li>
                 </ul>
            </div>
        </div>
        <div class="chat-container panel">
            <div class="chat-header">
                <img src="https://github.com/VeloProcess/PDP-Portal-de-Processos-/blob/main/unnamed%20(2).png?raw=true" alt="Logo" class="chat-logo">
                <h2 class="chat-title">Assistente Virtual <span class="status-indicator"></span></h2>
                <button id="theme-switcher" title="Alterar tema">‚òÄÔ∏è</button>
            </div>
            <div class="chat-box" id="chat-box"></div>
            <div class="input-area">
                <input type="text" id="user-input" placeholder="Digite sua mensagem..." autocomplete="off">
                <button id="send-button" class="action-button" title="Enviar mensagem">
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M3.478 2.405a.75.75 0 0 0-.926.94l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.405Z"></path></svg>
                </button>
                <button class="gemini-button" onclick="window.open('https://gemini.google.com/app')" title="Obter ajuda do Gemini AI">‚ú¶</button>
            </div>
        </div>
        <div id="news-panel" class="panel">
            <div class="panel-header">
                <h2>Not√≠cias e Alertas</h2>
            </div>
            <div id="news-list" style="padding: var(--espaco-md);">
                <div class="news-item critical-alert">
                    <h2>Desligamos a Antecipa√ß√£o novamente, pessoal</h2>
                    <small>Publicado em: 07/07/2025</small>
                    <p>Pessoal, para todos os clientes que entrarem em contato via chamada ou ticket, que questionar/demonstrar interesse na antecipa√ß√£o e/ou cr√©dito trabalhador, por favor, registrem na planilha abaixo, pois realizaremos o envio de notifica√ß√£o para os mesmos. üö®√â importante¬π mencionar que estamos realizando os testes finais e em breve ser√£o disponibilizados no aplicativo. üö®√â importante¬≤ ***N√ÉO*** mencionar nenhum prazo aos clientes. Conforme formos avan√ßando, informaremos √† voc√™s. [cite_start]Link e planilha no grupo B2C Recados e novidades!!</p> [cite: 179, 180, 181, 182]
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>

</body>
</html>
